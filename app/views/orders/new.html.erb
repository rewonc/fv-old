<%= render 'shared/status_bar', stage: 2 %>  


<div class="row">
  <div class="medium-8 small-12 columns">
    
<!-- Form -->         
    <div class="row form">
      <div class="small-12 columns">
        <h3 class="green">Delivery amount</h3>
        <p>You chose the <strong><%= @order.product.name %></strong> subscription.</p>
      
<%= form_for (@order) do |f| %>
  <% if @order.errors.any? %>
    <div id="error_explanation">
      <h4><%= pluralize(@order.errors.count, "error") %>:</h4>
      <ul>
      <% @order.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

<div class="row">
  <div class="small-7 medium-6 large-6 columns">
    <%= f.label @order.product.box_num_menu['title'] %>
    <%= f.select :box_count, @order.product.box_num_menu['options'].map{ |key, value| [value, key] }, {}, :'data-price' => @order.product.price, :'data-id' => @order.product.id %>
  </div>
  <div class="small-5 medium-6 large-6 columns">
      <%= f.label "Delivery frequency" %>
      <%= f.select :frequency, options_for_select([["Twice per week", "Twice per week"], ["Once per week", "Once per week"], ["Once per two weeks", "Once per two weeks"]], "Once per week") %>
  </div>
</div>

<div class="row">
  <div class="large-6 columns small-12 columns">


    <h3 class="green">Address and time</h3>
    <h5>Delivery address</h5>
    <div class="row">
      <div class="small-12 medium-10 columns">
        <div class="field">
          <%= f.label :"Full name" %>
          <%= f.text_field :fullname %>
        </div>
        <div class="field">
          <%= f.label :"Address" %>
          <%= f.text_field :address1 %>
        </div>
        <div class="field">
          <%= f.label :"Address (line two)" %>
          <%= f.text_field :address2 %>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="small-7 medium-5 columns">
        <div class="field">
          <%= f.label :city %>
          <%= f.text_field :city %>
        </div>
      </div>
      <div class="small-5 medium-3 columns">
        <div class="field">
          <%= f.label :state %>
          <%= f.text_field :state %>
        </div>
      </div>
      <div class="small-6 medium-4 columns">
        <div class="field">
           <%= f.label :zip %>
        <%= f.text_field :zip %>
        </div>
      </div>
    </div>    
  </div>

  <div class="large-6 columns small-12 columns">
    <h2>&nbsp;</h2>
      <h5>Time preference</h5>
      <div class="field">
        <%= f.label :delivery_window, "Delivery day  <a>(?)</a>".html_safe %>
        <%= f.select(:delivery_window, options_for_select([["Tuesday"],["Thursday"]])) %>
      </div>
      <div class="field">
        <%= f.hidden_field :first_delivery %>
      </div>
        <%= f.label :"Phone number" %>
        <%= f.text_field :phone, :placeholder => "e.g. 203-333-4567" %>
    
    
      <%= f.submit id: "order-submit", value: "Checkout", class: "fv-button" %>
    
  </div>
</div>


<% end %>

      </div>
    </div>
  </div>


<!-- End Form -->  

  <div class="medium-4 small-12 columns">
    

    <div class="row summary">
      <div class="small-12 columns">
        <h3 class="green">Summary</h3>
        <h5><%= @order.product.box_num_menu['title'] %>:</h5>
        <p id="boxcountstring"><%= @order.box_count_string %></p>

        <% if !@order.product.is_affiliate? %>
        <h5><%= @order.product.delivery_frequency_menu['title'] %>:</h5>
        <p><%= @order.frequency_string %></p>
        <% end %>

        <% if !@order.product.is_affiliate? %>
          <h5>First delivery:</h5>
          <p><%= @order.delivery_window.to_s %></p>

          <h3 class="green">First delivery</h3>
          <p><%= @order.first_delivery_string %> (<a href="#">change</a>)</p>
        <% else %>
          <h5>First delivery:</h5>
          <p id="firstdeliverystring"><%= @order.first_delivery.to_s %></p>
        <% end %>

        <h3 class="green">Total price</h3>
        <div class="pricer">
          <div class="text-right">Subtotal: <span id="subtotalprice"><%= @order.price_string(false) %></span></div>
          <div class="text-right"><em>Free delivery!</em></div>
          <div class="text-right"><strong>Total: <span id="totalprice"><%= @order.price_string(false) %></span></strong></div>
        </div>

        <h4 class="green">Notes</h4>
          <div class="row sub-summary">
             <div class="small-12 columns">
              <em><%= @order.product.note %></em>
            </div>
          </div>
      </div>
    </div>
  </div>
</div>



<% #call with empty array: right column doesnt show.  %>


<%#= render 'shared/order_bg_2', summary: {title: "hello world!"}, order: @order %> 

